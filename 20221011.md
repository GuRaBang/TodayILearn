# ë¯¸ë‹ˆí”„ë¡œì íŠ¸2 - ë¡œê·¸ì¸, íšŒì›ê°€ì… ê¸°ëŠ¥, ì‚¬ìš©ì ì •ë³´ ì €ì¥í•˜ê¸°
# ìš”êµ¬ì‚¬í•­

íšŒì›ê°€ì… ì‹œ - inputì„ submití•˜ë©´ ì–´ë”˜ê°€(state) ì €ì¥

ë¡œê·¸ì¸ ì‹œ - inputì„ submití•˜ë©´ ì €ì¥í•œ ê³³ì—ì„œ ë§¤ì¹­í•˜ì—¬ ë¡œê·¸ì¸ í—ˆìš©í•˜ê³  í•„ìš”ì‹œ ì •ë³´ë¥¼ êº¼ë‚´ì˜¬ ìˆ˜ ìˆë„ë¡ ë¡œì§ êµ¬í˜„

## êµ¬í˜„1

---

<ë™ì‘>

1. íšŒì›ê°€ì…ì‹œ stateì— ì €ì¥
2. ë¡œê·¸ì¸ ì‹œ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ë¥¼ stateì—ì„œ ë¡œë“œ

<index.html>

```jsx
<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="module" src="./index.js"></script>
    <title>login&signup</title>
  </head>
  <body>
    <div id="root">
      <form action="" method="post" class="signup">
        <input type="text" class="signup-id" />
        <input type="text" class="signup-password" />
        <input type="text" class="signup-confirm-password" />
        <button type="submit">submit</button>
      </form>
      <form action="" method="get" class="login">
        <input type="text" class="login-id" />
        <input type="text" class="login-password" />
        <button type="submit">submit</button>
      </form>
    </div>
  </body>
</html>
```

<state.js>

```jsx
let state = [
  {
    id: "aaa",
    password: "111",
  },
  {
    id: "bbb",
    password: "222",
  },
];

// ì…ë ¥ ë°›ì€ ì‚¬ìš©ì ì •ë³´ë¥¼ stateì— ì¶”ê°€
const setUser = (id, password) => {
  state = [...state, { id, password }];
  console.log(state);
};

// ì…ë ¥ ë°›ì€ ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜
const getUser = (userId, userPassword) => {
  return state.filter(
    ({ id, password }) => id === userId && password === userPassword
  );
};

const checkValidId = (userId) => {
  return state.filter(({ id }) => id === userId).length === 0;
};

export { setUser, getUser, checkValidId };
```

<index.js>

```jsx
import { setUser, getUser, checkValidId } from "./state.js";

document.querySelector(".signup").addEventListener("submit", (e) => {
  e.preventDefault();
  const id = e.target[0].value;
  const password = e.target[1].value;
  setUser(id, password);
});

document.querySelector(".login").addEventListener("submit", (e) => {
  e.preventDefault();
  const id = e.target[0].value;
  const password = e.target[1].value;
  console.log(getUser(id, password));
});
```

## ë‚´ê°€ ìƒê°í•œ ë¬¸ì œì 

1) formíƒœê·¸ì— submitì´ë²¤íŠ¸ë¡œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡í–ˆê¸° ë•Œë¬¸ì—  ëª¨ë“  inputìš”ì†Œì—ì„œ enterí‚¤ë¥¼ ëˆ„ë¥¼ ë•Œë§ˆë‹¤ submitì´ë²¤íŠ¸ê°€ ë°œìƒí•œë‹¤. 

2) íšŒì›ê°€ì… ì‹œ stateì— ì´ë¯¸ ì¡´ì¬í•˜ëŠ” idì¸ì§€ í™•ì¸ ì—†ì´ ì¶”ê°€í•˜ì—¬ ì¤‘ë³µë˜ëŠ” idê°€ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤. 

## í”¼ë“œë°±- ë” ì¤‘ìš”í•œ ë¬¸ì œ

1) ì‚¬ìš©ì ì •ë³´ëŠ” Viewë¥¼ ë°”ê¾¸ëŠ” ìƒíƒœê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— stateë¼ëŠ” ì´ë¦„ì´ ì ì ˆí•˜ì§€ ì•Šë‹¤. 

2) ì‚¬ìš©ì ì •ë³´ëŠ” ì˜ì†ì ìœ¼ë¡œ ì €ì¥ë˜ì–´ì•¼ í•œë‹¤.(ì„œë²„ì— ì €ì¥)

â‡’ ì„œë²„ êµ¬ì¶• í›„ jsoníŒŒì¼ë¡œ ë³€ê²½í•  ì˜ˆì •â€¼ ì„œë²„ êµ¬ì¶• ì „ ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì— ì‚¬ìš©ì ì •ë³´ë¥¼ ë”°ë¡œ ì €ì¥í•˜ê³  importí•´ì„œ ì‚¬ìš©í•˜ì˜€ë‹¤. 

3) ì €ì¥í•´ì•¼ í•˜ëŠ” ì •ë³´ëŠ” ë¡œê·¸ì¸ ì‹œ í™•ì¸í•˜ëŠ” ì •ë³´ ([1] ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸)ì™€ ì‚¬ìš©ìë§ˆë‹¤ ê°–ê³  ìˆëŠ” ê°œë³„ ì •ë³´ ([2] ì„¸íŒ…ê³¼ í‘¼ ë¬¸ì œë“¤)

---

## êµ¬í˜„2

1) ì‚¬ìš©ì ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì €ì¥ - /user-data/users.js 

```jsx
export default {
  users: [
    {
      id: "aaa",
      password: "111",
    },
    {
      id: "bbb",
      password: "222",
    },
  ],
};
```

2) ì‚¬ìš©ì ì„¤ì •(ëª‡ ì¼, ëª‡ ë¬¸ì œì”©, ì–´ë–¤ í”Œë«í¼)ê³¼ í‘¼ ë¬¸ì œ ì €ì¥ - /user-data/usersInfo.js

```jsx
export default {
  usersInfo: [
    {
      id: "aaa",
      setting: {
        day: 1,
        number: 2,
        platform: { baekjoon: true, leetcode: false, programmars: false },
      },
      problemList: [],
    },
    {
      id: "bbb",
      setting: {
        day: 1,
        number: 2,
        platform: { baekjoon: true, leetcode: false, programmars: false },
      },
      problemList: [],
    },
  ],
};
```

3) ì‚¬ìš©ì ì •ë³´ë¥¼ read, write, edití•˜ëŠ” í•¨ìˆ˜ë“¤ -  /user-data/user.js

```jsx
// import fs from "fs";
// const { users } = JSON.parse(fs.readFileSync("./user.json"));

import usersData from "./users.js";
import usersInfoData from "./usersInfo.js";
let { users } = usersData;
let { usersInfo } = usersInfoData;

const INITIAL_DAY = 1;
const INITIAL_NUMBER = 2;

// ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ id, passwordë¥¼ usersì™€ usersInfoì— ì €ì¥
// íšŒì›ê°€ì… ì‹œ 
const createUser = (id, password) => {
  users = [...users, { id, password }];
  usersInfo = [
    ...usersInfo,
    {
      id,
      setting: {
        day: INITIAL_DAY,
        number: INITIAL_NUMBER,
        platform: { baekjoon: true, leetcode: false, programmars: false },
      },
      problemList: [],
    },
  ];
};

// ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ id, passwordì™€ ì¼ì¹˜í•˜ëŠ” userInfoë¥¼ ë°˜í™˜. ì—†ëŠ” ê²½ìš° ë©”ì„¸ì§€ 
// ë¡œê·¸ì¸ ì‹œ 
const findUserInfo = (userId, userPassword) => {
  return users.includes(
    ({ id, password }) => id === userId && password === userPassword
  )
    ? usersInfo.find(({ id }) => id === userId)
    : "ì¼ì¹˜í•˜ëŠ” íšŒì› ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
};

// ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ idì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ ë°˜í™˜. 
// ì¤‘ë³µ ì•„ì´ë”” í™•ì¸ì‹œ ì‚¬ìš©
const findUserById = (userId) => {
  return users.find(({ id }) => id === userId) ? true : false;
};

// userIdì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ì˜ ì„¤ì • ê°’ì„ ê°±ì‹ 
// newSetting : object
//              {day: ? , number: ?, platform: {baekjoon: ?, leetcode: ?, programmars: ?}}
// ì„¤ì • ë³€ê²½ ì‹œ ì‚¬ìš©
const editUserSetting = (userId, newSetting) => {
  usersInfo = usersInfo.map((user) =>
    user.id === userId
      ? { ...user, setting: { ...user.setting, ...newSetting } }
      : user
  );
  console.log(usersInfo);
};

// userIdì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ì˜ í‘¼ ë¬¸ì œ ë°°ì—´ì„ ê°±ì‹ 
// newProblem : string
// ì œê³µí•˜ëŠ” ì •ë³´ì˜ ë§í¬ë¥¼ í´ë¦­í•˜ëŠ” ê²½ìš° ì‚¬ìš©
const addUserProblemList = (userId, newProblem) => {
  usersInfo = usersInfo.map((user) =>
    user.id === userId
      ? { ...user, problemList: [...user.problemList, newProblem] }
      : user
  );
  console.log(usersInfo);
};

export {
  createUser,
  findUserInfo,
  findUserById,
  editUserSetting,
  addUserProblemList,
};
```

depthê°€ ê¹Šì–´ì§€ëŠ” ê²½ìš° ì¸ìˆ˜ê°€ ë³µì¡í•´ì§€ê¸° ë•Œë¬¸ì— ì„¤ì •ê°’ ê°±ì‹ ê³¼ í‘¼ ë¬¸ì œë°°ì—´ ê°±ì‹ ì„ í•¨ìˆ˜ë¡œ ê°ê° êµ¬í˜„í•˜ì˜€ë‹¤. 

---

## êµ¬í˜„3

1) ìƒìˆ˜ëª…ì„ ë³€ê²½í–ˆë‹¤. 

2) ë¶„ë¦¬ë˜ì–´ ìˆë˜ CRUD í•¨ìˆ˜ë“¤ì„ Userê°ì²´ì˜ ë©”ì„œë“œë¡œ ë¬¶ì—ˆë‹¤. 

```jsx
// import fs from "fs";
// const { users } = JSON.parse(fs.readFileSync("./user.json"));

import usersData from "./users.js";
import usersInfoData from "./usersInfo.js";

const getObjectValue = (obj, key) => {
  return obj[key];
};

let users = getObjectValue(usersData, users);
let usersInfo = getObjectValue(usersInfoData, usersInfo);

const DEFAULT_DAY = 1;
const DEFAULT_NUMBER = 2;
const DEFAULT_PLATFORM = [baekjoon];

// ê°ê°ì˜ í•¨ìˆ˜ë“¤ì„ Userê°ì²´ì˜ ë©”ì„œë“œë¡œ ë³€ê²½
const User = {
  // ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ id, passwordë¥¼ usersì™€ usersInfoì— ì €ì¥
  // íšŒì›ê°€ì… ì‹œ
  create(id, password) {
    users = [...users, { id, password }];
    usersInfo = [
      ...usersInfo,
      {
        id,
        setting: {
          day: DEFAULT_DAY,
          number: DEFAULT_NUMBER,
          platform: DEFAULT_PLATFORM,
        },
        problemList: [],
      },
    ];
  },

  // ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ id, passwordì™€ ì¼ì¹˜í•˜ëŠ” userInfoë¥¼ ë°˜í™˜. ì—†ëŠ” ê²½ìš° ë©”ì„¸ì§€
  // ë¡œê·¸ì¸ ì‹œ
  findInfo(userId, userPassword) {
    return users.includes(
      ({ id, password }) => id === userId && password === userPassword
    )
      ? usersInfo.find(({ id }) => id === userId)
      : "ì¼ì¹˜í•˜ëŠ” íšŒì› ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
  },

  // ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ idì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ ë°˜í™˜.
  // ì¤‘ë³µ ì•„ì´ë”” í™•ì¸ì‹œ ì‚¬ìš©
  findById(userId) {
    return users.find(({ id }) => id === userId) ? true : false;
  },

  // userIdì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ì˜ ì„¤ì • ê°’ì„ ê°±ì‹ 
  // ì„¤ì • ë³€ê²½ ì‹œ ì‚¬ìš©
  editSetting(userId, newSetting) {
    usersInfo = usersInfo.map((user) =>
      user.id === userId
        ? { ...user, setting: { ...user.setting, ...newSetting } }
        : user
    );
  },

  // userIdì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ì˜ í‘¼ ë¬¸ì œ ë°°ì—´ì„ ê°±ì‹ 
  // ì œê³µí•˜ëŠ” ì •ë³´ì˜ ë§í¬ë¥¼ í´ë¦­í•˜ëŠ” ê²½ìš° ì‚¬ìš©
  addProblem(userId, newProblem) {
    usersInfo = usersInfo.map((user) =>
      user.id === userId
        ? { ...user, problemList: [...user.problemList, newProblem] }
        : user
    );
  },
};

export default User;
```

---

## êµ¬í˜„4 - ì„œë²„ ì—°ê²°

1. users.json - ì‚¬ìš©ì ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ 

```jsx
{"users":[{"id":"aaa","password":"111"},{"id":"bbb","password":"222"},{"id":"ccc","password":"333"},{"id":"ddd","password":"444"}]}
```

1. usersInfo.json - ì„¤ì •ì •ë³´ì™€ í‘¼ ë¬¸ì œ ì •ë³´

```jsx
{"usersInfo":[{"id":"aaa","setting":{"day":1,"number":2,"platform":["baekjoon"]},"problemList":["1.ìë°”ìŠ¤í¬ë¦½íŠ¸","2.CSS"]},{"id":"bbb","setting":{"day":1,"number":2,"platform":["baekjoon","leetcode"]},"problemList":[]},{"id":"ccc","setting":{"day":1,"number":2,"platform":["baekjoon"]},"problemList":[]},{"id":"ddd","setting":{"day":1,"number":2,"platform":["baekjoon"]},"problemList":[]}]}
```

1. user.js

```jsx
import fs from "fs";

const usersData = JSON.parse(fs.readFileSync("./user-data/users.json"));
const usersInfoData = JSON.parse(fs.readFileSync("./user-data/usersInfo.json"));

const getObjectValue = (obj, key) => {
  return obj[key];
};

let users = getObjectValue(usersData, "users");
let usersInfo = getObjectValue(usersInfoData, "usersInfo");

const DEFAULT_DAY = 1;
const DEFAULT_NUMBER = 2;
const DEFAULT_PLATFORM = ["baekjoon"];

// ê°ê°ì˜ í•¨ìˆ˜ë“¤ì„ Userê°ì²´ì˜ ë©”ì„œë“œë¡œ ë³€ê²½
const User = {
  // ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ id, passwordë¥¼ usersì™€ usersInfoì— ì €ì¥
  // íšŒì›ê°€ì… ì‹œ
  create(id, password) {
    users = [...users, { id, password }];
    usersInfo = [
      ...usersInfo,
      {
        id,
        setting: {
          day: DEFAULT_DAY,
          number: DEFAULT_NUMBER,
          platform: DEFAULT_PLATFORM,
        },
        problemList: [],
      },
    ];
    return { users, usersInfo };
  },

  // ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ id, passwordì™€ ì¼ì¹˜í•˜ëŠ” userInfoë¥¼ ë°˜í™˜. ì—†ëŠ” ê²½ìš° ë©”ì„¸ì§€
  // ë¡œê·¸ì¸ ì‹œ
  findInfo(userId, userPassword) {
    return users.find(
      ({ id, password }) => id === userId && password === userPassword
    )
      ? usersInfo.find(({ id }) => id === userId)
      : "ì¼ì¹˜í•˜ëŠ” íšŒì› ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
  },

  // ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ì€ idì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ ë°˜í™˜.
  // ì¤‘ë³µ ì•„ì´ë”” í™•ì¸ì‹œ ì‚¬ìš©
  findById(userId) {
    return users.find(({ id }) => id === userId) ? true : false;
  },

  // userIdì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ì˜ ì„¤ì • ê°’ì„ ê°±ì‹ 
  // ì„¤ì • ë³€ê²½ ì‹œ ì‚¬ìš©
  editSetting(userId, newSetting) {
    usersInfo = usersInfo.map((user) =>
      user.id === userId
        ? { ...user, setting: { ...user.setting, ...newSetting } }
        : user
    );
    return usersInfo;
  },

  // userIdì™€ ì¼ì¹˜í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ì˜ í‘¼ ë¬¸ì œ ë°°ì—´ì„ ê°±ì‹ 
  // ì œê³µí•˜ëŠ” ì •ë³´ì˜ ë§í¬ë¥¼ í´ë¦­í•˜ëŠ” ê²½ìš° ì‚¬ìš©
  addProblem(userId, newProblem) {
    usersInfo = usersInfo.map((user) =>
      user.id === userId
        ? { ...user, problemList: [...user.problemList, newProblem] }
        : user
    );
    return usersInfo;
  },
};

export default User;
```

1. server.js

```jsx
import express from "express";
import dotenv from "dotenv";
import fs from "fs";
import User from "./user-data/user.js";

dotenv.config();

const app = express();
const port = process.env.PORT || 9000;

app.use(express.static("./"));
app.use(express.json());

app.listen(port, () => {
  console.log(`app listening on http://localhost:${port}`);
});

// íšŒì›ê°€ì…
app.post("/signup", (req, res) => {
  const { id, password } = req.body;
  const { users, usersInfo } = User.create(id, password);
  res.json(usersInfo);
  fs.writeFileSync(
    "./user-data/users.json",
    JSON.stringify({ users: users }),
    "utf-8"
  );
  fs.writeFileSync(
    "./user-data/usersInfo.json",
    JSON.stringify({ usersInfo: usersInfo }),
    "utf-8"
  );
});

// ë¡œê·¸ì¸
app.post("/signin", (req, res) => {
  const { id, password } = req.body;
  const usersInfo = User.findInfo(id, password);
  res.json(usersInfo);
});

// ì„¤ì •
app.patch("/setting/:id", (req, res) => {
  const { id } = req.params;
  const payload = req.body;
  const usersInfo = User.editSetting(id, payload);
  res.json(usersInfo);
  fs.writeFileSync(
    "./user-data/usersInfo.json",
    JSON.stringify({ usersInfo: usersInfo }),
    "utf-8"
  );
});

// í‘¼ ë¬¸ì œ 
app.patch("/solve/:id", (req, res) => {
  const { id } = req.params;
  const { problem } = req.body;
  const usersInfo = User.addProblem(id, problem);
  res.json(usersInfo);
  fs.writeFileSync(
    "./user-data/usersInfo.json",
    JSON.stringify({ usersInfo: usersInfo }),
    "utf-8"
  );
});
```

## í”¼ë“œë°±

- ì‚¬ìš©ì ì¸ì¦ì •ë³´(ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸)ì™€ ì‚¬ìš©ì ì •ë³´(ì„¤ì •, ë°›ì€ ë¬¸ì œë“¤ etc)ëŠ” ë‹¤ë¥¸ dbì— ê°ê° ì €ì¥í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì¸ì¦ì •ë³´ëŠ” ë¡œê·¸ì¸ì´ë‚˜ íšŒì›ê°€ì…ì‹œ ì¶”ê°€, í™•ì¸ë§Œ í•˜ê³  ì„œë¹„ìŠ¤ì— í•„ìš”í•œ ì •ë³´ëŠ” ì‚¬ìš©ì ì •ë³´ì—ì„œ êº¼ë‚´ì™€ì„œ ê°€ê³µí•˜ëŠ” ê²ƒì´ë‹¤.
- dbë¥¼ ë¶„ë¦¬í•˜ì˜€ì„ ë•Œ dbì— ì ‘ê·¼í•˜ëŠ” í•¨ìˆ˜(í”„ë¡œì íŠ¸ì—ì„œëŠ” crud.js)ëŠ” ìì‹ ì˜ dbì—ë§Œ ì ‘ê·¼í•´ì•¼í•˜ê³  ë‹¤ë¥¸ dbëŠ” ëª°ë¼ì•¼í•œë‹¤.
- server.jsì—ì„œëŠ” crudí•¨ìˆ˜ë“¤ì„ importí•´ì„œ ì‚¬ìš©í•œë‹¤. dbì— ì§ì ‘ ì ‘ê·¼í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ crudí•¨ìˆ˜ë¥¼ í†µí•´ ê°„ì ‘ì ìœ¼ë¡œ ì ‘ê·¼í•œë‹¤.

---

## êµ¬í˜„5

1. db/auth/crud.js

```jsx
let data = JSON.parse(fs.readFileSync(path.join(__dirname, './db.json')));

module.exports = {
  create(id, password) {
    data = [...data, { id, password }];

    return { data };
  },
  isValid(id, password) {
    return data.find(({ id: _id, password: _password }) => _id === id && _password === password);
  },

};
```

1. db/user/crud.js

```jsx
const problems = require('../problems/crud.js');
let data = JSON.parse(fs.readFileSync(path.join(__dirname, './db.json')));

const DEFAULT_DAY = 1;
const DEFAULT_NUMBER = 2;
const DEFAULT_PLATFORM = ['boj'];

const setData = newData => {
  data = newData;
  fs.writeFileSync(path.join(__dirname, './db.json'), JSON.stringify(newData));
};

module.exports = {
  create(id) {
    const date = new Date();
    setData([
      ...data,
      {
        lastVisit: date,
        id,
        setting: {
          day: DEFAULT_DAY,
          number: DEFAULT_NUMBER,
          platform: DEFAULT_PLATFORM,
          lastUpdate: date,
        },
        problemList: [],
      },
    ]);
  },
  updateSetting(id, newSetting) {
    setData(data.map(user => (user.id === id ? { ...user, setting: { ...user.setting, ...newSetting } } : user)));
  },

  addProblem(id, amount) {
    // ìƒˆì‚¥ ì¶”ê°€
    const { problemList } = this.getInfo(id);
    const date = new Date();

    const newProblems = problems
      .getRandom(amount, {
        exceptIds: problemList.flatMap(({ id }) => id),
      })
      .map(problem => ({ ...problem, solved: false, givenDate: date }));

    setData(
      data.map(user => (user.id === id ? { ...user, problemList: [...user.problemList, ...newProblems] } : user))
    );
  },
  getInfo(id) {
    return data.find(user => user.id === id);
  },
};
```

1. server.js

```jsx
const dotenv = require('dotenv');
const express = require('express');
const cookieParser = require('cookie-parser');
const jwt = require('jsonwebtoken');
const path = require('path');
const user = require('./db/user/crud.js');
const auth = require('./db/auth/crud.js');

dotenv.config();

const app = express();
const port = process.env.PORT || 9000;

app.use(cookieParser());

const verify = (req, res, next) => {
  const { accessToken } = req.cookies;

  try {
    const decoded = jwt.verify(accessToken, process.env.JWT_SECRET_KEY);
    console.log(`ğŸ˜€ ì‚¬ìš©ì ì¸ì¦ ì„±ê³µ`, decoded);
  } catch (e) {
    console.error('ğŸ˜± ì‚¬ìš©ì ì¸ì¦ ì‹¤íŒ¨..');
  } finally {
    next();
  }
};

app.get('/', verify, (req, res) => {
  res.sendFile(path.join(__dirname, './index.html'));
});

app.use(express.static(path.join(__dirname, '/')));
app.use(express.json());

app.get('*', verify, (req, res) => {
  res.sendFile(path.join(__dirname, './index.html'));
});

app.post('/signin', (req, res) => {
  const { id, password } = req.body;
  if (!id || !password) return res.status(401).send({ error: 'ì‚¬ìš©ì ì•„ì´ë”” ë˜ëŠ” íŒ¨ìŠ¤ì›Œë“œê°€ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.' });

  if (!auth.isValid(id, password)) return res.status(401).send({ error: 'ë“±ë¡ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤.' });

  const accessToken = jwt.sign({ id }, process.env.JWT_SECRET_KEY, {
    expiresIn: '1d',
  });

  res.cookie('accessToken', accessToken, {
    maxAge: 1000 * 60 * 60 * 24 * 7, // 7d
    httpOnly: true,
  });

  res.json(user.getInfo(id));
});

app.post('/add', (req, res) => {
  const { id } = req.body;
  const {
    setting: { number },
  } = user.getInfo(id);

  user.addProblem(id, number);
  res.json(user.getInfo(id));
});

app.listen(port, () => {
  console.log(`app listening on http://localhost:${port}`);
});
```
